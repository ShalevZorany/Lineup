<!DOCTYPE html>
<html lang="he">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Line-Up Builder</title>
<style>
 body{font-family:Arial,Helvetica,sans-serif;text-align:center;margin:0}
 #controls{margin:1rem auto;max-width:600px;display:flex;gap:.5rem;flex-wrap:wrap;justify-content:center}
 select,button{padding:.35rem .7rem;font-size:1rem}
 /*—  מגרש —*/
 #field{
   width:min(70vw,450px);   /* מצטמצם במסכים קטנים */
   aspect-ratio:2/3;        /* 68×105 מטר ≈ 2:3 */
   position:relative;
   margin:1rem auto;
   border:4px solid #fff;
   border-radius:8px;
   background:#32853d;
   background:repeating-linear-gradient(90deg,#308534 0 5%,#2e7d32 5% 10%); /* פסים כמו דשא אירופי */
 }
 /* קו אמצע ואופקי */
 #field::before,#field::after{content:"";position:absolute;left:50%;transform:translateX(-50%);background:#fff;pointer-events:none}
 #field::before{width:2px;height:100%}
 #field::after{top:50%;width:100%;height:2px}
 /* אלמנט קווי מגרש נוספים */
 .pitch-lines{position:absolute;inset:0;pointer-events:none}
 .center-circle{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:30%;aspect-ratio:1/1;border:2px solid #fff;border-radius:50%}
 .penalty-box{position:absolute;top:50%;transform:translateY(-50%);width:18%;height:30%;border:2px solid #fff}
 .penalty-box.left{left:0;border-right:none}
 .penalty-box.right{right:0;border-left:none}
 .goal-box{position:absolute;top:50%;transform:translateY(-50%);width:6%;height:12%;border:2px solid #fff}
 .goal-box.left{left:0;border-right:none}
 .goal-box.right{right:0;border-left:none}
 .penalty-spot{position:absolute;width:6px;height:6px;background:#fff;border-radius:50%}
 .penalty-spot.left{left:12%;top:50%;transform:translateY(-50%)}
 .penalty-spot.right{right:12%;top:50%;transform:translateY(-50%)}
 /* שחקן */
 .player{position:absolute;width:60px;height:60px;border-radius:50%;background:rgba(255,255,255,.85);border:2px solid #000;cursor:grab;display:flex;flex-direction:column;align-items:center;justify-content:center;font-weight:bold;user-select:none;touch-action:none}
 .player span.number{font-size:1.25rem;line-height:1}
 .player span.name{font-size:.72rem}
</style>
</head>
<body>
<h1>Line-Up Builder</h1>

<div id="controls">
  <label>Formation:
    <select id="formationSelect">
      <option value="4-4-2">4-4-2</option>
      <option value="4-3-3">4-3-3</option>
      <option value="3-5-2">3-5-2</option>
      <option value="5-3-2">5-3-2</option>
    </select>
  </label>
  <button id="addPlayerBtn">Add Player</button>
  <button id="resetBtn">Reset Positions</button>
</div>

<!-- המגרש -->
<div id="field">
  <div class="pitch-lines">
    <div class="center-circle"></div>
    <div class="penalty-box left"></div>
    <div class="penalty-box right"></div>
    <div class="goal-box left"></div>
    <div class="goal-box right"></div>
    <div class="penalty-spot left"></div>
    <div class="penalty-spot right"></div>
  </div>
</div>

<script>
const field=document.getElementById('field');
const formationSelect=document.getElementById('formationSelect');
const addPlayerBtn=document.getElementById('addPlayerBtn');
const resetBtn=document.getElementById('resetBtn');
let players=[];

function createPlayer(name="Player",number=players.length+1,x=50,y=90){
  const el=document.createElement('div');
  el.className='player';
  el.style.left=`${x}%`;
  el.style.top=`${y}%`;
  el.innerHTML=`<span class="number">${number}</span><span class="name">${name}</span>`;
  field.appendChild(el);
  makeDraggable(el);
  el.ondblclick=()=>{
    const newName=prompt("Player name:",name);
    const newNumber=prompt("Player number:",number);
    if(newName!==null) name=newName;
    if(newNumber!==null) number=newNumber;
    el.querySelector('.name').textContent=name;
    el.querySelector('.number').textContent=number;
  };
  players.push(el);
}

function makeDraggable(el){
  let offsetX,offsetY,dragging=false;
  el.addEventListener('pointerdown',e=>{
    dragging=true;
    el.setPointerCapture(e.pointerId);
    const rect=el.getBoundingClientRect();
    offsetX=e.clientX-rect.left;
    offsetY=e.clientY-rect.top;
  });
  el.addEventListener('pointermove',e=>{
    if(!dragging) return;
    const fieldRect=field.getBoundingClientRect();
    const newX=((e.clientX-fieldRect.left-offsetX)/fieldRect.width)*100;
    const newY=((e.clientY-fieldRect.top-offsetY)/fieldRect.height)*100;
    el.style.left=`${Math.min(Math.max(newX,0),100)}%`;
    el.style.top=`${Math.min(Math.max(newY,0),100)}%`;
  });
  el.addEventListener('pointerup',()=>dragging=false);
}

const formations={
  "4-4-2":[
    [50,95],
    [15,75],[40,75],[60,75],[85,75],
    [15,50],[40,50],[60,50],[85,50],
    [35,25],[65,25]
  ],
  "4-3-3":[
    [50,95],
    [15,75],[40,75],[60,75],[85,75],
    [25,55],[50,55],[75,55],
    [15,30],[50,25],[85,30]
  ],
  "3-5-2":[
    [50,95],
    [25,75],[50,75],[75,75],
    [10,55],[30,50],[50,45],[70,50],[90,55],
    [35,25],[65,25]
  ],
  "5-3-2":[
    [50,95],
    [10,75],[30,75],[50,75],[70,75],[90,75],
    [25,50],[50,50],[75,50],
    [35,25],[65,25]
  ]
};

function applyFormation(name){
  clearPlayers();
  formations[name].forEach((pos,i)=>createPlayer(`P${i+1}`,i+1,pos[0],pos[1]));
}
function clearPlayers(){
  players.forEach(p=>p.remove());
  players=[];
}
formationSelect.onchange=()=>applyFormation(formationSelect.value);
addPlayerBtn.onclick=()=>createPlayer(`P${players.length+1}`,players.length+1,50,50);
resetBtn.onclick=()=>applyFormation(formationSelect.value);
applyFormation(formationSelect.value);
</script>
</body>
</html>
